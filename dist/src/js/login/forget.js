function code(){var e=["q","w","e","r","t","y","u","i","o","p","a","s","d","f","g","h","j","k","l","z","x","c","v","b","n","m","0","1","2","3","4","5","6","7","8","9","Q","W","E","R","T","Y","U","I","O","P","A","S","D","F","G","H","J","K","L","Z","X","C","V","B","N","M"],s=parseInt(1e4*Math.random()%62),o=parseInt(1e4*Math.random()%62),t=parseInt(1e4*Math.random()%62),n=parseInt(1e4*Math.random()%62);imgStr=e[n]+e[s]+e[o]+e[t],$(".code i").text(imgStr)}function times(){var e=60;g=!0,c=!0;var s=setInterval(function(){e--,$(".styles").text(e+"秒后再次获取"),e<1&&($(".styles").text("重新获取"),$(".styles").css({background:"#49CB86"}),clearInterval(s),f=!0,g=!1)},1e3)}var d=!1,e=!1,g=!1,c=!1,f=!1;$(".btn1").click(function(){var s=$(".phone").val().trim();if(""==s||null==s)return $(".phoneMeg").css({display:"block"}),$(".phoneMeg span").text("手机号码不能为空"),void(e=!1);var o=$(".imgCode").val().trim();if(""==o||null==o)return $(".imgMeg").css({display:"block"}),$(".imgMeg span").text("图片验证码不能为空"),void(f=!1);if($(".phone").blur(),e&&($(".imgCode").blur(),f)){var t=$(".SMScode").val().trim();if(""==t||null==t)return $(".SMScodeMsg").css({display:"block"}),$(".SMScodeMsg span").text("短信验证码不能为空"),void(d=!1);if($(".phone").blur(),e&&($(".imgCode").blur(),f&&($(".SMScode").blur(),d))){if(!c)return $(".SMScodeMsg span").text("请先获取验证码"),void $(".SMScodeMsg").css({display:"block"});$(".SMScodeMsg").css({display:"none"});var n=$(".phone").val().trim(),i=$(".SMScode").val().trim(),a={sendNum:n,sendMode:1,verifyCode:i};$.ajax({type:"GET",url:"/cloudlink-core-framework/login/checkVerifyCode",contentType:"application/json",data:a,dataType:"json",success:function(s,o){if(1!=s.success)return $(".SMScodeMsg").css({display:"block"}),void $(".SMScodeMsg span").text("手机号或验证码错误");$(".top img").attr("src","src/images/enrollImg/2.png"),$(".bottom1,.bottom3,.bottom4,.Notes").css({display:"none"}),$(".bottom2").css({display:"block"}),$(".top img").attr("src","src/images/forgetImg/2.png"),$(".bottom1").css({display:"none"}),$(".bottom2").css({display:"block"}),e=!1,f=!1,d=!1,g=!1}})}}}),$(".btn2").click(function(){var s=$(".phone").val().trim(),o=MD5($(".pw1").val().trim()),t=MD5($(".pw2").val().trim()),n=$(".SMScode").val().trim();if(""==o||null==o)return $(".pswMsg1").css({display:"block"}),$(".pswMsg1 span").text("密码不能为空"),void(e=!1);if(""==t||null==t)return $(".pswMsg2").css({display:"block"}),$(".pswMsg2 span").text("请再次输入密码"),void(f=!1);if($(".pw1").blur(),e&&($(".pw2").blur(),f)){var i={mobileNum:s,password:o,verifyCode:n};$.ajax({url:"/cloudlink-core-framework/login/resetPassword",type:"POST",contentType:"application/json",data:JSON.stringify(i),dataType:"json",success:function(e,o){$(".top img").attr("src","src/images/forgetImg/3.png"),$(".bottom2").css({display:"none"}),$(".bottom3").css({display:"block"}),1==zhugeSwitch&&zhuge.track("重置密码成功",{"手机号":s})}})}}),$(".btnhid").click(function(){location.href="login.html"});var imgStr="";code(),$(".code").click(function(){code()}),$(".phone").blur(function(){var s=$(this).val().trim(),o=/^1\d{10}$/;if(""==s||null==s)return void(e=!1);if(!o.test(s))return $(".phoneMeg").css({display:"block"}),$(".phoneMeg span").text("手机号码填写错误"),e=!1,!1;$(".phoneMeg").css({display:"none"});var t={registNum:s};$.ajax({url:"/cloudlink-core-framework/login/isExist",type:"GET",contentType:"application/json",data:t,dataType:"json",success:function(s,o){1==s.rows.isExist?($(".phoneMeg").css({display:"none"}),e=!0):($(".phoneMeg").css({display:"block"}),$(".phoneMeg span").text("手机号码未注册"),e=!1)}})}),$(".imgCode").blur(function(){var e=$(this).val().trim(),s=new RegExp("^"+imgStr+"$","gi");return""==e||null==e?void(f=!1):s.test(e)?($(".imgMeg").css({display:"none"}),g||$(".styles").css({background:"#49CB86"}),f=!0,void 0):($(".imgMeg").css({display:"block"}),$(".imgMeg span").text("图片验证码填写错误"),void(f=!1))}),$(".SMScode").blur(function(){var e=$(this).val().trim();if(""==e||null==e)return void(d=!1);d=!0,$(".SMScodeMsg").css({display:"none"})}),$(".styles").click(function(){var s=$(".phone").val().trim();if(""==s||null==s)return $(".phoneMeg").css({display:"block"}),void $(".phoneMeg span").text("手机号码不能为空");var o=$(".imgCode").val().trim();if(""==o||null==o)return $(".imgMeg").css({display:"block"}),void $(".imgMeg span").text("图片验证码不能为空");if($(".phone").blur(),$(".imgCode").blur(),console.log(e,g,f),f&&!g&&e){$(".phone").blur(),times(),$(".styles").text("60秒后再次获取"),$(".styles").css({background:"#ccc"}),f=!1;var t=$(".phone").val().trim(),n={sendNum:t,sendMode:1,useMode:3};$.ajax({url:"/cloudlink-core-framework/login/getVerifyCode",type:"GET",contentType:"application/json",dataType:"json",data:n,success:function(e){}})}}),$(".pw1").blur(function(){if(!/^[\dA-z]{6,12}$/.test($(this).val().trim()))return $(".pswMsg1").css({display:"block"}),$(".pswMsg1 span").text("请输入6-12位数字或字母"),void(e=!1);e=!0,$(".pswMsg1").css({display:"none"})}),$(".pw2").blur(function(){var e=$(".pw1").val().trim(),s=$(".pw2").val().trim();return""==s||null==s?void(f=!1):e!=s?($(".pswMsg2").css({display:"block"}),$(".pswMsg2 span").text("两次输入密码不一致"),void(f=!1)):(f=!0,void $(".pswMsg2").css({display:"none"}))});