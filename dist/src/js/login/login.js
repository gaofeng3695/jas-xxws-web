function accountNumber(){var e={registNum:nameVal};$.ajax({type:"GET",url:"/cloudlink-core-framework/login/isExist",contentType:"application/json",data:e,dataType:"json",success:function(e,a){return 0==e.rows.isExist?($(".hidkuai1 span").text("账号未注册"),1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":nameVal,"原因":"账号未注册"}),!1):(requestData(),!0)}})}function requestData(){var e={loginNum:nameVal,password:passwordVal};$.ajax({type:"POST",url:"/cloudlink-core-framework/login/loginByPassword",contentType:"application/json",data:JSON.stringify(e),dataType:"json",success:function(e){if(1==e.success){var a=e.rows,n=e.token;lsObj.setLocalStorage("token",n),lsObj.setLocalStorage("userBo",JSON.stringify(a[0])),lsObj.setLocalStorage("timeOut",(new Date).getTime()+828e5),getDefaultEnterpriseId(a[0].objectId)}else{if("U01"==e.code)return $(".hidkuai2 span").text("用户名和密码不一致"),void(1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":nameVal,"原因":"用户名和密码不一致"}));if("U02"==e.code)return $(".hidkuai2 span").text("该用户未注册"),void(1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":nameVal,"原因":"该用户未注册"}));if("U03"==e.code)return void $(".hidkuai2 span").text("该用户已注册");if("U04"==e.code)return void $(".hidkuai2 span").text("该账户已冻结");if("400"==e.code)return void $(".hidkuai2 span").text("代码异常");if("401"==e.code)return void $(".hidkuai2 span").text("参数异常")}},error:function(e,a,n){console.log(e),console.log(a),console.log(n)}})}function getDefaultEnterpriseId(e){$.ajax({type:"POST",url:"/cloudlink-core-framework/login/getDefaultEnterpriseId",contentType:"application/json",data:JSON.stringify({userId:e}),dataType:"json",success:function(e){if(1==e.success)if(e.rows.length>0){var a=e.rows[0].enterpriseId;joinDefaultEnterprise(a)}else location.href="src/html/loginSet.html",$(".hidkuai2 span").text("当前用户未设置默认登录企业")},error:function(e,a,n){console.log(e),console.log(a),console.log(n)}})}function joinDefaultEnterprise(e){var a=JSON.parse(lsObj.getLocalStorage("userBo"));$.ajax({type:"POST",url:"/cloudlink-core-framework/login/joinEnterprise",contentType:"application/json",data:JSON.stringify({userId:a.objectId,enterpriseId:e}),dataType:"json",success:function(e){if(1==e.success){var n=e.rows,t=e.token;lsObj.setLocalStorage("token",t),lsObj.setLocalStorage("userBo",JSON.stringify(n[0])),lsObj.setLocalStorage("timeOut",(new Date).getTime()+828e5),1==zhugeSwitch&&(zhugeIdentify(n[0]),zhuge.track("登陆成功")),location.href="main.html"}else switch(e.code){case"400":$(".hidkuai2 span").text("服务异常"),1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":a.mobileNum,"原因":"服务异常"});break;case"401":$(".hidkuai2 span").text("参数异常"),1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":a.mobileNum,"原因":"参数异常"});break;case"E01":$(".hidkuai2 span").text("您的账户已被该企业冻结"),1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":a.mobileNum,"原因":"您的账户已被该企业冻结"});break;case"E02":$(".hidkuai2 span").text("您的账户已被该企业移除"),1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":a.mobileNum,"原因":"您的账户已被该企业移除"});break;case"E03":$(".hidkuai2 span").text("该企业不存在"),1==zhugeSwitch&&zhuge.track("登陆失败",{"手机号":a.mobileNum,"原因":"该企业不存在"})}},error:function(e,a,n){console.log(e),console.log(a),console.log(n)}})}function zhugeIdentify(e){zhuge.identify(e.objectId,{name:e.userName,gender:e.sex,age:e.age,email:e.email,qq:e.qq,weixin:e.wechat,mobile:e.mobileNum,"企业名称":null==e.enterpriseName?"":e.enterpriseName,"部门名称":null==e.orgName?"":e.orgName})}var Obj={nameImg:"url(src/images/loginImg/nameImg.png)",nameImg1:"url(src/images/loginImg/nameImg1.png)",passwordImg:"url(src/images/loginImg/password1.png)",passwordImg1:"url(src/images/loginImg/password.png)",focus:function(e,a){e.css({background:"#ECF7FF",border:"1px solid #5EB6F9"}),e.find("input").css("background","#ECF7FF"),e.find(".common").css("border-left","1px solid #5EB6F9"),e.find(".bg").css("background-image",a)},blur:function(e,a){e.css({background:"#fff",border:"1px solid #bbb"}),e.find("input").css("background","#fff"),e.find(".common").css("border-left","1px solid #bbb"),e.find(".bg").css("background-image",a)}};$(".name input").focus(function(){Obj.focus($(".name"),Obj.nameImg)}).blur(function(){Obj.blur($(".name"),Obj.nameImg1)}),$(".password input").focus(function(){Obj.focus($(".password"),Obj.passwordImg)}).blur(function(){Obj.blur($(".password"),Obj.passwordImg1)});var passwordVal=null,nameVal=null;$(".btn").click(function(){nameVal=$(".name input").val().trim(),passwordVal=MD5($(".password input").val().trim());var e=/^1\d{10}$/;return""==nameVal||null==nameVal?($(".hidkuai1 span").text("手机号码不能为空"),void $(".password input").val("")):e.test(nameVal)?""==passwordVal||null==passwordVal?($(".hidkuai1 span").text(""),void $(".hidkuai2 span").text("密码不能为空")):($(".hidkuai1 span").text(""),$(".hidkuai2 span").text(""),accountNumber(),void 0):void $(".hidkuai1 span").text("您输入的手机号码不正确")});