$(function(){usermanager.init()});var usermanager={$searchInput:$("#searchInput"),querryObj:{pageNum:1,pageSize:10},searchObj:{},init:function(){this.inittable(),this.bindEvent()},inittable:function(){var e=this;$("#table").bootstrapTable({url:"/cloudlink-core-framework/user/queryPageByOrgId?token="+lsObj.getLocalStorage("token"),method:"GET",toolbar:"#toolbar",toolbarAlign:"left",cache:!1,showHeader:!0,showRefresh:!0,striped:!0,pagination:!0,sidePagination:"server",pageNumber:1,pageSize:10,pageList:[10,20,50],queryParamsType:"",queryParams:function(r){return e.searchObj.pageSize=r.pageSize,e.searchObj.pageNum=r.pageNumber,e.searchObj.status="1",e.searchObj.enterpriseId=JSON.parse(lsObj.getLocalStorage("userBo")).enterpriseId,e.searchObj},responseHandler:function(e){return e},columns:[{field:"userName",title:"姓名",align:"center",visible:!0,sortable:!1,width:"16%",editable:!0,valign:"middle"},{field:"mobileNum",title:"手机号",align:"center",visible:!0,sortable:!1,width:"16%",editable:!0,valign:"middle"},{field:"orgName",title:"部门",align:"center",visible:!0,sortable:!1,width:"16%",editable:!0,valign:"middle"},{field:"roleNames",title:"角色",align:"center",visible:!0,sortable:!1,width:"16%",valign:"middle"},{field:"position",title:"职位",align:"center",visible:!0,sortable:!1,width:"16%",editable:!0,valign:"middle",formatter:function(e,r,t){return null==e||""==e?"":e}},{field:"operation",title:"操作",align:"center",events:operateEvents,formatter:function(e,r,t){var a="";return a=r.objectId==JSON.parse(lsObj.getLocalStorage("userBo")).objectId?'<button class="disabledremove"  href="javascript:void(0)" title="移交" disabled>移交</button>':'<button class="remove"  href="javascript:void(0)" title="移交">移交</button>',[a].join("")}}]})},bindEvent:function(){var e=this;$("#gf_Btn").click(function(){var r=$(this).parent().find("input").val();e.querryObj.keyWord=r,e.refreshTable()}),e.$searchInput.keypress(function(r){if(r&&13===r.keyCode){var t=$(this).parent().find("input").val();e.querryObj.keyWord=t,e.refreshTable()}}),$("#searchInput").bind("keyup",function(r){"8"==r.keyCode&&(e.querryObj.keyWord="",e.refreshTable())})},refreshTable:function(){var e=this;e.querryObj.pageNum="1",$("#table").bootstrapTable("refreshOptions",{pageNumber:+e.querryObj.pageNum,pageSize:+e.querryObj.pageSize,queryParams:function(r){return e.querryObj.pageSize=r.pageSize,e.querryObj.pageNum=r.pageNumber,e.querryObj.enterpriseId=JSON.parse(lsObj.getLocalStorage("userBo")).enterpriseId,e.querryObj.status="1",e.querryObj}})}};window.operateEvents={"click .remove":function(e,r,t,a){var i=JSON.parse(lsObj.getLocalStorage("userBo")),n={enterpriseId:t.enterpriseId,to:t.objectId,from:i.objectId,fromUserName:i.userName,enterpriseName:i.enterpriseName,functionNames:"企业管理",signName:""},s={tip:"是否将系统管理员权限移交给"+t.userName+"("+t.mobileNum+")，移交后将会自动退出登录。",name_title:"系统管理员移交",name_cancel:"取消",name_confirm:"确定",isCancelBtnShow:!0,callBack:function(){$.ajax({url:"/cloudlink-core-framework/user/changeEnpAdminAndSendMsm",async:!1,contentType:"application/json",data:JSON.stringify(n),type:"post",dataType:"json",success:function(e,r){1==e.success?(lsObj.clearAll(),parent.location.href="../../login.html"):xxwsWindowObj.xxwsAlert("服务异常，请稍候重试")}})}};xxwsWindowObj.xxwsAlert(s)}};