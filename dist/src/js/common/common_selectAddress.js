!function(t,e){function n(t){var n={dataUrl:"/demo/address/city.json",defalutId:"",provinceSelector:"",citySelector:"",countySelector:"",townSelector:""},i=e.extend(n,t,!0);this.defalutId=i.defalutId,this.result={provinceCode:"",cityCode:"",countyCode:"",townCode:i.defalutId,provinceName:"",cityName:"",countyName:"",townName:"",address:""},this.initElems(i),this.requestData(i.dataUrl)}var i=function(t){return new n(t)};n.prototype={constructor:n,initElems:function(t){this.provinceDom=e(t.provinceSelector),this.cityDom=e(t.citySelector),this.countyDom=e(t.countySelector),this.townDom=e(t.townSelector)},requestData:function(t){var i=this;n.data?(i.render(i.defalutId),this.bindEvent()):e.ajax({type:"GET",url:t,dataType:"json",success:function(t){n.data=t,i.render(i.defalutId),i.bindEvent()},error:function(t){alert("请求数据出错，请检查网络")}})},bindEvent:function(){var t=this;this.provinceDom.on("change",function(){t.setValueAndupdateResult("province",this.value),t.cityDom.val("0").trigger("change"),t.renderSelect("city",this.value)}),this.cityDom.on("change",function(){t.setValueAndupdateResult("city",this.value),t.countyDom.val("0").trigger("change"),t.renderSelect("county",this.value)}),this.countyDom.on("change",function(){t.setValueAndupdateResult("county",this.value),t.townDom.val("0").trigger("change"),t.renderSelect("town",this.value)}),this.townDom.on("change",function(){t.setValueAndupdateResult("town",this.value)})},render:function(t){this.initDefaultAddress(t)},renderSelect:function(t,e,i){var o=n.data[t].filter(function(t,n){return"0"===t.parentId||t.parentId===e}),s=['<option value="0">请选择</option>'];o.forEach(function(t,e){s.push('<option value="'+t.code+'">'+t.name+"</option>")}),1===s.length?this[t+"Dom"].attr("disabled","disabled"):this[t+"Dom"].attr("disabled",!1),this[t+"Dom"].html(s.join("")).val("0"),this.setValueAndupdateResult(t,i)},setValueAndupdateResult:function(t,e){var n=this[t+"Dom"];n.val(e||"0"),this.result[t+"Code"]=+e||"",this.result[t+"Name"]=+e?n.find("option:selected").text():"",this.result.address=this.result.provinceName+this.result.cityName+this.result.countyName+this.result.townName},initDefaultAddress:function(t){var e=t?t.substring(0,2)+"0000000000":"0",n=t?t.substring(0,4)+"00000000":"0",i=t?t.substring(0,6)+"000000":"0";this.renderSelect("province","0",e),this.renderSelect("city",e,n),this.renderSelect("county",n,i),this.renderSelect("town",i,t)}},t.setAddress=i}(window,jQuery);