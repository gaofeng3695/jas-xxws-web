function getAudioContext(){if(!gAudioContext)try{gAudioContext=new AudioContext}catch(e){}return gAudioContext}function fetchBlob(e,t){var o=new XMLHttpRequest;o.open("GET",e),o.responseType="blob",o.onload=function(){t(this.response)},o.onerror=function(){alert("Failed to fetch "+e)},o.send()}function readBlob(e,t){var o=new FileReader;o.onload=function(e){var o=new Uint8Array(e.target.result);t(o)},o.readAsArrayBuffer(e)}function fetchAndReadBlob(e,t){fetchBlob(e,function(e){readBlob(e,t)})}function playAmrBlob(e,t){readBlob(e,function(e){playAmrArray(e)})}function convertAudioBlobToAmr(e){readBlob(e,function(e){getAudioContext().decodeAudioData(e.buffer,function(e){var t;e.copyFromChannel?(t=new Float32Array(e.length),e.copyFromChannel(t,0,0)):t=e.getChannelData(0),playAmrArray(AMR.encode(t,e.sampleRate,7))})})}function playAmrArray(e){var t=AMR.decode(e);if(!t)return void alert("Failed to decode!");playPcm(t)}function playPcm(e){var t=getAudioContext(),o=t.createBufferSource(),n=t.createBuffer(1,e.length,8e3);if(n.copyToChannel)n.copyToChannel(e,0,0);else{n.getChannelData(0).set(e)}o.buffer=n,o.connect(t.destination),o.start()}function convertAmrBlobToWav(e){readBlob(e,function(e){var t=AMR.toWAV(e);E("pre").textContent=toHex(t);var o=URL.createObjectURL(new Blob([t],{type:"audio/x-wav"})),n=new Audio(o);n.onloadedmetadata=n.onerror=function(){URL.revokeObjectURL(o)},n.play()})}function toHex(e){for(var t="",o=0;o<e.length;o++){var n=e[o].toString(16);1==n.length&&(n="0"+n),t+=n,o%16==15?t+="\n":o%2==1&&(t+=" ")}return t}try{var gAudioContext=new AudioContext}catch(e){}